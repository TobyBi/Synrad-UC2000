<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc" />
    <title>UC2000 API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style type="text/css">/*! * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/) * Copyright 2011-2020 The Bootstrap Authors * Copyright 2011-2020 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style type="text/css">/*! pygments */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.codehilite .hll{background-color:#ffffcc}.codehilite .c{color:#408080; font-style:italic}.codehilite .err{border:1px solid #FF0000}.codehilite .k{color:#008000; font-weight:bold}.codehilite .o{color:#666666}.codehilite .ch{color:#408080; font-style:italic}.codehilite .cm{color:#408080; font-style:italic}.codehilite .cp{color:#BC7A00}.codehilite .cpf{color:#408080; font-style:italic}.codehilite .c1{color:#408080; font-style:italic}.codehilite .cs{color:#408080; font-style:italic}.codehilite .gd{color:#A00000}.codehilite .ge{font-style:italic}.codehilite .gr{color:#FF0000}.codehilite .gh{color:#000080; font-weight:bold}.codehilite .gi{color:#00A000}.codehilite .go{color:#888888}.codehilite .gp{color:#000080; font-weight:bold}.codehilite .gs{font-weight:bold}.codehilite .gu{color:#800080; font-weight:bold}.codehilite .gt{color:#0044DD}.codehilite .kc{color:#008000; font-weight:bold}.codehilite .kd{color:#008000; font-weight:bold}.codehilite .kn{color:#008000; font-weight:bold}.codehilite .kp{color:#008000}.codehilite .kr{color:#008000; font-weight:bold}.codehilite .kt{color:#B00040}.codehilite .m{color:#666666}.codehilite .s{color:#BA2121}.codehilite .na{color:#7D9029}.codehilite .nb{color:#008000}.codehilite .nc{color:#0000FF; font-weight:bold}.codehilite .no{color:#880000}.codehilite .nd{color:#AA22FF}.codehilite .ni{color:#999999; font-weight:bold}.codehilite .ne{color:#D2413A; font-weight:bold}.codehilite .nf{color:#0000FF}.codehilite .nl{color:#A0A000}.codehilite .nn{color:#0000FF; font-weight:bold}.codehilite .nt{color:#008000; font-weight:bold}.codehilite .nv{color:#19177C}.codehilite .ow{color:#AA22FF; font-weight:bold}.codehilite .w{color:#bbbbbb}.codehilite .mb{color:#666666}.codehilite .mf{color:#666666}.codehilite .mh{color:#666666}.codehilite .mi{color:#666666}.codehilite .mo{color:#666666}.codehilite .sa{color:#BA2121}.codehilite .sb{color:#BA2121}.codehilite .sc{color:#BA2121}.codehilite .dl{color:#BA2121}.codehilite .sd{color:#BA2121; font-style:italic}.codehilite .s2{color:#BA2121}.codehilite .se{color:#BB6622; font-weight:bold}.codehilite .sh{color:#BA2121}.codehilite .si{color:#BB6688; font-weight:bold}.codehilite .sx{color:#008000}.codehilite .sr{color:#BB6688}.codehilite .s1{color:#BA2121}.codehilite .ss{color:#19177C}.codehilite .bp{color:#008000}.codehilite .fm{color:#0000FF}.codehilite .vc{color:#19177C}.codehilite .vg{color:#19177C}.codehilite .vi{color:#19177C}.codehilite .vm{color:#19177C}.codehilite .il{color:#666666}</style>
<style type="text/css">/*! pdoc */html, main{scroll-behavior:smooth;}h1, h2, h3, h4{font-weight:300;margin:.3em 0;padding:.2em 0;}a{text-decoration:none;color:#3660a5;}code{color:#24292e;padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;}pre code{display:inline-block;background:none;padding:0;}blockquote{margin-left:2rem;}.button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}html, body{width:100%;height:100%;}@media (max-width:769px){label[for=navtoggle]{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;color:rgba(0, 0, 0, .55);border-color:rgba(0, 0, 0, .1);background-repeat:no-repeat;background-position:center center;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%280, 0, 0, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");}main{padding:2rem 3vw;}label[for=navtoggle]:hover{border-color:rgba(0, 0, 0, .5);}#navtoggle + div{display:none;}#navtoggle:checked + div{display:inherit;}.git-button{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}label[for=navtoggle]{display:none;}}#navtoggle{display:none;}nav{--pad:1.75rem;--indent:1.5rem;background-color:#eee;border-right:1px solid #c1c1c1;box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;}nav > div{padding:var(--pad) 0;}nav::-webkit-scrollbar{width:10px;}nav{scrollbar-width:thin;}nav::-webkit-scrollbar-thumb{background-color:#c1c1c1;}.module-list-button{background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-box-arrow-in-left%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M10%203.5a.5.5%200%200%200-.5-.5h-8a.5.5%200%200%200-.5.5v9a.5.5%200%200%200%20.5.5h8a.5.5%200%200%200%20.5-.5v-2a.5.5%200%200%201%201%200v2A1.5%201.5%200%200%201%209.5%2014h-8A1.5%201.5%200%200%201%200%2012.5v-9A1.5%201.5%200%200%201%201.5%202h8A1.5%201.5%200%200%201%2011%203.5v2a.5.5%200%200%201-1%200v-2z%22/%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M4.146%208.354a.5.5%200%200%201%200-.708l3-3a.5.5%200%201%201%20.708.708L5.707%207.5H14.5a.5.5%200%200%201%200%201H5.707l2.147%202.146a.5.5%200%200%201-.708.708l-3-3z%22/%3E%0A%3C/svg%3E");background-position:1em center;background-repeat:no-repeat;color:#333;border-color:#999;padding-left:calc(1em + 18px);margin-bottom:1rem;}.module-list-button:hover{border-color:black;}nav ul{list-style:none;padding-left:0;}nav li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav > div > ul > li{padding-left:0;}nav li:hover{background-color:rgba(255, 255, 255, 0.5);}nav a{color:#333;display:block;}nav .class:before, .inherited .class:before{content:"class ";color:gray;}nav > h2:first-of-type{margin-top:1.5rem;}nav .function:after, .inherited .function a:after{content:"()";color:gray;}main{overflow-x:hidden;}main > section:first-of-type .docstring{margin-bottom:3rem;}.git-button{float:right;border:solid #3273dc 1px;}.git-button:hover{background-color:#3273dc;color:white;}.modulename{margin-top:0;font-weight:bold;}.modulename a{color:#3660a5;transition:100ms all;}.modulename a:hover{color:#1659c5;}details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;}details:not([open]){height:0;overflow:visible;}summary.button{color:#666;border-width:0;padding:0 .7em;display:inline-block;user-select:none;}summary:focus{outline:0;}details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}pre{background-color:#f7f7f7;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin-bottom:.5em;padding:.5rem 0 .5rem .5rem;}pre > code{padding:0;background:none;}.docstring pre{margin-left:1em;margin-right:1em;}.docstring{margin-bottom:1.5rem;}h1:target, h2:target, h3:target, h4:target, h5:target, h6:target{background-color:#fff7a8;box-shadow:-1rem 0 0 0 #fff7a8;}div:target > .attr, section:target > .attr{background-color:#fff598;}.attr:hover{background-color:#dadada;}.attr{color:black;margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:#eee;}.classattr, .inherited{margin-left:2rem;}.name{color:#0066BB;font-weight:bold;}.def{color:#008800;font-weight:bold;}.function .signature{white-space:pre-wrap;}.annotation{color:#007020;}dt, dd{display:inline;}dd:not(:last-child):after{content:", ";}.int, .nonetype{color:#666;}.str{color:#BA2121;}.logo{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.logo:hover{opacity:1;filter:grayscale(0%);}.logo svg{margin-left:5px;height:35px;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav>
            <label for="navtoggle" class="button"></label>
            <input id="navtoggle" type="checkbox">
            <div>



                    <h2>API Documentation</h2>
                            <ul class="memberlist">
                <li>
                        <a class="class" href="#UC2000Controller">UC2000Controller</a>
                                    <ul class="memberlist">
                            <li>
                                    <a class="function" href="#UC2000Controller.__init__">UC2000Controller</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.checksum">checksum</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.lase">lase</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.percent">percent</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.pwm_freq">pwm_freq</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.gate_logic">gate_logic</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.max_pwm">max_pwm</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.lase_on_power_up">lase_on_power_up</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.mode">mode</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.max_power">max_power</a>
                            </li>
                            <li>
                                    <a class="variable" href="#UC2000Controller.power">power</a>
                            </li>
                            <li>
                                    <a class="function" href="#UC2000Controller.reset">reset</a>
                            </li>
                            <li>
                                    <a class="function" href="#UC2000Controller.shoot">shoot</a>
                            </li>
                    </ul>

                </li>
                <li>
                        <a class="class" href="#Message">Message</a>
                                    <ul class="memberlist">
                            <li>
                                    <a class="function" href="#Message.__init__">Message</a>
                            </li>
                            <li>
                                    <a class="variable" href="#Message.message_bytes">message_bytes</a>
                            </li>
                            <li>
                                    <a class="function" href="#Message.add_no_carry">add_no_carry</a>
                            </li>
                    </ul>

                </li>
        </ul>


                    <a class="logo" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <svg xmlns="http://www.w3.org/2000/svg" width="300" height="150" viewBox="-1 0 60 30" class="pdoc-logo"><path d="M29.621 21.293c-.011-.273-.214-.475-.511-.481a.5.5 0 0 0-.489.503l-.044 1.393c-.097.551-.695 1.215-1.566 1.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43 3.43 0 0 0-.365-.306.49.49 0 0 0-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707 1.187-3.413 2.131-4.328 1.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351 1.378-1.008 2.271-2.586 2.271-4.362 0-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516 0-1.477-1.202-2.679-2.679-2.679-.791 0-1.496.352-1.987.9a6.3 6.3 0 0 0-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477 0-2.679 1.202-2.679 2.679A2.65 2.65 0 0 0 .97 6.554c-.383.747-.595 1.572-.595 2.41 0 2.311 1.507 4.29 3.635 5.107-.037.699-.147 2.27-.423 3.294l-.137.461c-.622 2.042-2.515 8.257 1.727 10.643 1.614.908 3.06 1.248 4.317 1.248 2.665 0 4.492-1.524 5.322-2.401 1.476-1.559 2.886-1.854 6.491.82 1.877 1.393 3.514 1.753 4.861 1.068 2.223-1.713 2.811-3.867 3.399-6.374.077-.846.056-1.469.054-1.537zm-4.835 4.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693 1.198 1.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145 1.189.368 1.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056 1.211-.031zm-4.535 1.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66 11.66 0 0 0 .972-.573zm.983-.664c.359-.237.738-.418 1.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381 1.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133 0-.306-.26-.45-.621.417.091.854.07 1.291-.031zm-2.066-8.077a4.78 4.78 0 0 1-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331 2.302a10.32 10.32 0 0 1-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45 2.157l-.701-.403c.214-.115.536-.249.891-.376a11.57 11.57 0 0 1-.19.779zm-.181 1.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87 4.141c0 .152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15 1.15 0 0 0-.314.783 1.16 1.16 0 0 0 1.162 1.162c.457 0 .842-.27 1.032-.653.026.117.042.238.042.362a1.68 1.68 0 0 1-1.679 1.679 1.68 1.68 0 0 1-1.679-1.679c0-.843.626-1.535 1.436-1.654zM5.059 5.406A1.68 1.68 0 0 1 3.38 7.085a1.68 1.68 0 0 1-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16 1.16 0 0 0 1.162-1.162 1.14 1.14 0 0 0-.474-.912c.015 0 .03-.005.045-.005.926.001 1.679.754 1.679 1.68zM3.198 4.141c0 .152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375 8.964c0-.52.103-1.035.288-1.52.466.394 1.06.64 1.717.64 1.144 0 2.116-.725 2.499-1.738.383 1.012 1.355 1.738 2.499 1.738.867 0 1.631-.421 2.121-1.062.307.605.478 1.267.478 1.942 0 2.486-2.153 4.51-4.801 4.51s-4.801-2.023-4.801-4.51zm24.342 19.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315 1.391-4.163 3.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11 6.11 0 0 0 1.18.115 6.01 6.01 0 0 0 2.536-.562l-.006.175c-.802.215-1.848.612-2.021 1.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311 1.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381 1.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999 1.429-.018.278.095.532.316.713.675.556 1.231.721 1.653.721.059 0 .104-.014.158-.02.207.707.641 1.64 1.513 1.64h.013c.8-.008 1.236-.345 1.462-.626.173-.216.268-.457.325-.692.424.195.93.374 1.372.374.151 0 .294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15 0 .294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356 0 .595-.101.767-.229.438.435 1.094.992 1.656 1.067.106.014.205.021.296.021a1.56 1.56 0 0 0 .323-.035c.17.575.453 1.289.866 1.605.358.273.665.362.914.362a.99.99 0 0 0 .421-.093 1.03 1.03 0 0 0 .245-.164c.168.428.39.846.68 1.068.358.273.665.362.913.362a.99.99 0 0 0 .421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127 0 .25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443 1.486-1.107 2.761-2.086 3.257zM8.66 9.925a.5.5 0 1 0-1 0c0 .653-.818 1.205-1.787 1.205s-1.787-.552-1.787-1.205a.5.5 0 1 0-1 0c0 1.216 1.25 2.205 2.787 2.205s2.787-.989 2.787-2.205zm4.4 15.965l-.208.097c-2.661 1.258-4.708 1.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4 0 0 0-.385-.414c-.242-.029-.406.164-.414.385-.046 1.249.367 3.686 2.202 4.896.708.467 1.547.7 2.51.7 1.248 0 2.706-.392 4.362-1.174l.185-.086a.4.4 0 0 0 .205-.527c-.089-.204-.326-.291-.527-.206zM9.547 2.292c.093.077.205.114.317.114a.5.5 0 0 0 .318-.886L8.817.397a.5.5 0 0 0-.703.068.5.5 0 0 0 .069.703l1.364 1.124zm-7.661-.065c.086 0 .173-.022.253-.068l1.523-.893a.5.5 0 0 0-.506-.863l-1.523.892a.5.5 0 0 0-.179.685c.094.158.261.247.432.247z" transform="matrix(-1 0 0 1 58 0)" fill="#3bb300"/><path d="M.3 21.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54 1.34-.54 1.06 0 1.42.28.38.26.44.78.76-1.04 2.38-1.04 1.64 0 3.1 1.54 1.46 1.54 1.46 3.58 0 2.04-1.46 3.58-1.44 1.54-3.08 1.54-1.64 0-2.38-.92v4.04q0 .46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62 0-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46 1.18 0 .64.46 1.18.48.52 1.2.52.74 0 1.24-.52.52-.52.52-1.18 0-.66-.48-1.18-.48-.54-1.26-.54-.76 0-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12 1-.12.64 0 1.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0 .46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38 0-1.54-.98-.84.96-2.34.96-1.8 0-3.28-1.56-1.48-1.58-1.48-3.66 0-2.1 1.48-3.68 1.5-1.58 3.28-1.58 1.48 0 2.3 1v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24 10.86q.52.54 1.26.54.74 0 1.22-.54.5-.54.5-1.18 0-.66-.48-1.22-.46-.56-1.26-.56-.8 0-1.28.56-.48.54-.48 1.2 0 .66.52 1.2zm7.833-1.2q0-2.4 1.68-3.96 1.68-1.56 3.84-1.56 2.16 0 3.82 1.56 1.66 1.54 1.66 3.94 0 1.66-.86 2.96-.86 1.28-2.1 1.9-1.22.6-2.54.6-1.32 0-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18 1.44q.64.48 1.3.48.66 0 1.32-.5.66-.5.66-1.48 0-.98-.62-1.46-.62-.48-1.34-.48-.72 0-1.34.5-.62.5-.62 1.48 0 .96.64 1.46zm11.412-1.44q0 .84.56 1.32.56.46 1.18.46.64 0 1.18-.36.56-.38.9-.38.6 0 1.46 1.06.46.58.46 1.04 0 .76-1.1 1.42-1.14.8-2.8.8-1.86 0-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36 0-1.3.52-2.34.52-1.06 1.34-1.7 1.66-1.32 3.54-1.32.76 0 1.48.22.72.2 1.06.4l.32.2q.36.24.56.38.52.4.52.92 0 .5-.42 1.14-.72 1.1-1.38 1.1-.38 0-1.08-.44-.36-.34-1.04-.34-.66 0-1.24.48-.58.48-.58 1.34z" fill="green"/></svg>                    </a>
            </div>
        </nav>
    <main>
            <section>
                <h1 class="modulename">
UC2000                </h1>
                
                            <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># =============================================================================</span>
<span class="c1"># Parameters for UC2000 object</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># Minimum step size of PWM percent</span>
<span class="n">PERCENT_STEP</span> <span class="o">=</span>          <span class="mf">0.5</span>
<span class="c1"># Transforming PWM percent incompatible without checksum to compatible ones</span>
<span class="n">PERCENT_TRANSFORMS</span> <span class="o">=</span>    <span class="p">{</span><span class="mi">63</span><span class="p">:</span> <span class="mf">62.5</span><span class="p">}</span>
<span class="c1"># Valid shot time range</span>
<span class="n">SHOT_TIME_RANGE</span> <span class="o">=</span>       <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
<span class="c1"># Minimum percent required for laser to be considered OFF to material without</span>
<span class="c1"># turning the Command signal OFF</span>
<span class="n">MIN_LASE_PERCENT</span> <span class="o">=</span>      <span class="mi">2</span>
<span class="n">UC2000_DEFAULT_SETTINGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;pwm_freq&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>   <span class="c1"># Higher PWM frequency means lower ripple in optical beam response</span>
    <span class="s2">&quot;gate_logic&quot;</span><span class="p">:</span>       <span class="s2">&quot;up&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_pwm&quot;</span><span class="p">:</span>          <span class="mi">95</span><span class="p">,</span>
    <span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;mode&quot;</span><span class="p">:</span>             <span class="s2">&quot;manual&quot;</span><span class="p">,</span> <span class="c1"># this will be different for reflow and laser machining</span>
    <span class="s2">&quot;lase&quot;</span><span class="p">:</span>             <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;percent&quot;</span><span class="p">:</span>          <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># TODO: update RC params style?</span>
<span class="c1"># TODO: set defaults list into controller as argument for changable settings</span>

<span class="k">class</span> <span class="nc">UC2000Controller</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An interface to SYNRAD 48 series CO2 lasers through UC-2000 controller.  </span>

<span class="sd">    Communication to the UC-2000 controller from a host using REMOTE  </span>
<span class="sd">    settings are facilitated through the Serial RS-232 protocol and port.  </span>

<span class="sd">    Parameters  </span>
<span class="sd">    ----------  </span>
<span class="sd">    model : {25, 50}  </span>
<span class="sd">        SYNRAD 48 series laser model number, indicates the maximum  </span>
<span class="sd">        optical power output  </span>
<span class="sd">    open_labjack : LabJack object  </span>
<span class="sd">        A LabJack object to transmit messages to the UC-2000,  </span>
<span class="sd">        by default False.  </span>

<span class="sd">    Attributes  </span>
<span class="sd">    ----------  </span>
<span class="sd">    lase  </span>
<span class="sd">    percent  </span>
<span class="sd">    pwm_freq  </span>
<span class="sd">    gate_logic  </span>
<span class="sd">    max_pwm  </span>
<span class="sd">    lase_on_power_up  </span>
<span class="sd">    mode  </span>
<span class="sd">    checksum  </span>
<span class="sd">    max_power  </span>
<span class="sd">    power  </span>
<span class="sd">    model  </span>
<span class="sd">    open_labjack  </span>
<span class="sd">    PARAMETER_NAME_hist : list  </span>
<span class="sd">        Entire history of previous PARAMETER_NAME from instantiation.  </span>

<span class="sd">    Methods  </span>
<span class="sd">    -------  </span>
<span class="sd">    reset()  </span>
<span class="sd">        Reset all UC-2000 to default.  </span>
<span class="sd">    shoot(shot_percent, shot_time, num_shots)  </span>
<span class="sd">        Fires a number of shots of a given optical power percent for a   </span>
<span class="sd">        given time.  </span>

<span class="sd">    Notes  </span>
<span class="sd">    -----  </span>
<span class="sd">    Pins 2, 3, and 5 of a serial port are used for receive, transmit, and   </span>
<span class="sd">    ground respectively.  </span>
<span class="sd">    The host serial port configuration must be  </span>
<span class="sd">        Baud rate       9600  </span>
<span class="sd">        Data bits       8 bits  </span>
<span class="sd">        Parity          None  </span>
<span class="sd">        Stop bits       1 bit  </span>
<span class="sd">        Flow control    None  </span>

<span class="sd">    For further details please refer to:  </span>
<span class="sd">    https://synrad.com/en/products/accessories/uc-2000  </span>

<span class="sd">    Messages are sent to the UC-2000 from the host via a DAQ, in this case  </span>
<span class="sd">    a LabJack T4/T7 is used. However, any source that can produce RS-232   </span>
<span class="sd">    asynchronous communication can be used. If a Labjack object or no other  </span>
<span class="sd">    DAQ is provided then the UC-2000 only stores messages.  </span>

<span class="sd">    TODO: LUA scripting - call script to improve timings  </span>
<span class="sd">    TODO: gate pull-up/down, SYNRAD doesn&#39;t know whether gate or comamnd signal activate lasing is faster. Trial and error?  </span>

<span class="sd">    TODO: receiving communication from the labjack... or using the UC2000 response  </span>
<span class="sd">        if check_ack:  </span>
<span class="sd">            daq_response = daq_stats[&quot;response&quot;]  </span>

<span class="sd">            if not isinstance(daq_response, list):  </span>
<span class="sd">                daq_response = [daq_response]  </span>

<span class="sd">            if UC2000_RESPONSE[&quot;ack&quot;] in daq_response:  </span>
<span class="sd">                self.laser_controller.set_any(setting, option)  </span>
<span class="sd">                gui_message = &quot;\&quot;{0}\&quot; has changed to \&quot;{1}\&quot;&quot;.format(setting, option)  </span>
<span class="sd">                action = &quot;continue&quot;  </span>
<span class="sd">                outcome = option  </span>
<span class="sd">            elif UC2000_RESPONSE[&quot;nak&quot;] in daq_response:  </span>
<span class="sd">                gui_message = &quot;\&quot;{0}\&quot; remains unchanged as {1} because UC2000 didn&#39;t accept the message&quot;.format(setting, prev)  </span>
<span class="sd">                action = &quot;previous&quot;  </span>
<span class="sd">                outcome = prev  </span>
<span class="sd">            else:</span>
<span class="sd">                gui_message = &quot;Setting \&quot;{0}\&quot; remains unchanged as {1} because there has been no response from UC2000&quot;.format(setting, prev)  </span>
<span class="sd">                action = &quot;previous&quot;  </span>
<span class="sd">                outcome = prev  </span>
<span class="sd">        else:  </span>
<span class="sd">            self.laser_controller.set_any(setting, option)  </span>
<span class="sd">            gui_message = &quot;Setting \&quot;{0}\&quot; has changed to \&quot;{1}\&quot;&quot;.format(setting, option)  </span>
<span class="sd">            action = &quot;continue&quot;  </span>
<span class="sd">            outcome = option  </span>

<span class="sd">    TODO: test with slightly longer wait time between asynch communications  </span>
<span class="sd">    TODO: can send remote status byte inbetween start and end transmission byte of any other  </span>
<span class="sd">    command - maybe use to check option on laser  </span>

<span class="sd">    Examples  </span>
<span class="sd">    --------  </span>
<span class="sd">    &gt;&gt;&gt; laser = UC2000Controller(model=25)  </span>
<span class="sd">    &gt;&gt;&gt; with laser:  </span>
<span class="sd">    ...     laser.percent = 20  </span>
<span class="sd">    ...     laser.lase = True  </span>
<span class="sd">    ...     laser.percent = 0  </span>
<span class="sd">    ...     laser.lase = False  </span>

<span class="sd">    Demonstration of the .percent and .lase commands  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">open_labjack</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a UC2000 object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span> <span class="o">=</span> <span class="n">open_labjack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum_hist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Assumes that Checksum mode is enabled... </span>
        <span class="c1"># and why would we not use checksum mode anyways</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="kc">True</span>      

        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Laser process stopped by user&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># returning False because we want to allow nested with statements </span>
            <span class="c1"># above the stack to also use their __exit__ which turns the laser</span>
            <span class="c1"># off and low set percent.</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># turn it down anyways</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return lase state.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lase</span>
    
    <span class="nd">@lase</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set lase state to either True or False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : bool</span>
<span class="sd">            New set lase state.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Lase state is controlled by a Command signal for LOW (0 - 0.5V DC) </span>
<span class="sd">        and HIGH (3.5 - 5V DC).</span>

<span class="sd">        When the Command signal is low for &gt;200us, the UC-2000 always supplies </span>
<span class="sd">        laser with 5kHz, 1us tickle pulse that pre-ionises the laser gas to </span>
<span class="sd">        just below lasing threshold. Any increase in pulse width causes </span>
<span class="sd">        emission as enough energy is added to the plasma.</span>

<span class="sd">        If a labjack is connected, then a LASE message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lase</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># if the new option is the same as before don&#39;t send changes to labjack</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;lase&quot;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return laser percent, representing the PWM signal duty cycle percentage.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_percent</span>

    <span class="nd">@percent</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">per</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set laser percent (PWM signal duty cycle percentage), limited to </span>
<span class="sd">        between 0 and 95/99% in steps of 0.5%.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        per : float</span>
<span class="sd">            New PWM duty cycle percentage, in seteps of 0.5%</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The laser percent defaults to previous percent if new percent is </span>
<span class="sd">        outside of the permitted range. If self.checksum flag is True, then the</span>
<span class="sd">        set laser percent cannot be 63% defaults to 62.5% instead.</span>

<span class="sd">        The PWM signal duty cycle controls how much of the Command signal&#39;s </span>
<span class="sd">        pulse is HIGH. When the Command signal is HIGH, the laser RF amplifiers </span>
<span class="sd">        are HIGH and this increases the optical output power.</span>

<span class="sd">        If a labjack is connected, then a SET message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_percent_limits</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_percent</span> <span class="o">=</span> <span class="n">per</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pwm_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return laser PWM frequency.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_freq</span>

    <span class="nd">@pwm_freq</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pwm_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set laser PWM frequency to either 5, 10, or 20kHz.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        freq : {5, 10, 20}</span>
<span class="sd">            New laser percent.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The PWM frequency of the Command signal, where the laser optical output </span>
<span class="sd">        follows the Command signal with a rise/fall time of 75-150us. A higher </span>
<span class="sd">        PWM frequency means the laser output response has less ripple and at </span>
<span class="sd">        20kHz the laser output is nearly CW with small ripple.</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">freq</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;pwm_freq&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gate_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return gate pull up/down status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gate_logic</span>
    
    <span class="nd">@gate_logic</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gate_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pull</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set gate pull up/down status to either pull &quot;up&quot; or &quot;down&quot;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pull : {&quot;up&quot;, &quot;down&quot;}</span>
<span class="sd">            New gate pull status.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Gate pull up indicates that the laser will fire without a gate signal.</span>
<span class="sd">        This means the UC-2000 connects an internal resistor between the gate</span>
<span class="sd">        and command signal.</span>

<span class="sd">        Gate pull down means the laser will fire when the gate signal is HIGH </span>
<span class="sd">        and the command signal is HIGH. A gate signal is supplied to the Gate </span>
<span class="sd">        BNC input and is either logic LOW (0 - 0.9V DC) or HIGH (2.8 - 5 V DC). </span>
<span class="sd">        Now, the tickle pulse and command signals are determined by the </span>
<span class="sd">        Gating amplitude.</span>

<span class="sd">        Note: PWM and gate pulses are not asynchronous, the edges of both </span>
<span class="sd">        pulses are not synchronised.</span>

<span class="sd">        Input impedence: 50 kOhms</span>
<span class="sd">        Gate On Time, min: 3.5us (10ms in closed loop mode)/</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gate_logic</span> <span class="o">=</span> <span class="n">pull</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pull</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pull</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;gate_logic&quot;</span><span class="p">,</span> <span class="n">pull</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the maximum PWM perentage or maximum duty cycle time.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_pwm</span>

    <span class="nd">@max_pwm</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">max_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">per</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the maximum PWM percentage of the Command signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        per : {95, 99}</span>
<span class="sd">            New max PWM percentage.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        SYNRAD lasers have max PWM percentage of 95% by default to increase</span>
<span class="sd">        longevity of lasers as greater than 95% increases heat load and &quot;may</span>
<span class="sd">        cause thermal instability and optical degradation.&quot;</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_pwm</span> <span class="o">=</span> <span class="n">per</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;max_pwm&quot;</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lase_on_power_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return lase on power-up status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lase_on_power_up</span>
    
    <span class="nd">@lase_on_power_up</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lase_on_power_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set lase on power-up status to either True or False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pwr : bool</span>
<span class="sd">            New lase on power-up setting.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If the lase on power-up status is ON, then the UC-2000 controller will</span>
<span class="sd">        send a lase signal immediately when the power is turned on. Used only</span>
<span class="sd">        when access to UC-2000 controller is limited.</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lase_on_power_up</span> <span class="o">=</span> <span class="n">pwr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pwr</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">,</span> <span class="n">pwr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return UC-2000 operating mode.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span>

    <span class="nd">@mode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set UC-2000 operating mode to 5 possible choices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode_type : {&quot;manual&quot;, &quot;anc&quot;, &quot;anv&quot; &quot;man_closed&quot;, &quot;anv_closed&quot;}</span>
<span class="sd">            New operating mode.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        MANUAL (&quot;manual&quot;)</span>
<span class="sd">        Laser output power is adjusted by the PWM command signal duty cycle</span>
<span class="sd">        percentage.</span>

<span class="sd">        ANC (&quot;anc&quot;)</span>
<span class="sd">        Laser power controlled by external 4-20mA current loop. PWM duty cycle</span>
<span class="sd">        changes proportionally to applied current.</span>

<span class="sd">        ANV (&quot;anv&quot;)</span>
<span class="sd">        Laser power controlled by external analog 0-10V source where the duty </span>
<span class="sd">        cycle is proportional to external voltage.</span>

<span class="sd">        MAN. CLOSED (&quot;man_closed&quot;)</span>
<span class="sd">        Closed loop power is ensured by Closed Loop Stablization Kit which</span>
<span class="sd">        regulates power stability to within +/-2% of the setpoint. Closed loop</span>
<span class="sd">        settling time is typically 2ms after setpoint change. The recommended</span>
<span class="sd">        lower and upper control range is 20-80% PWM duty cycle percent.</span>

<span class="sd">        ANV CLOSED (&quot;anv_closed&quot;)</span>
<span class="sd">        Similar to MAN. CLOSED except an external analog voltage is stabilised.</span>

<span class="sd">        If a labjack is connected, then a MODE message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mode_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">mode_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return checksum protocol use.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checksum</span>

    <span class="nd">@checksum</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set checksum protocol used for commands sent through the RS-232 protocol.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : bool</span>
<span class="sd">            New checksum enable or disable option.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Only changes the message sent by Python and not the message sent by the</span>
<span class="sd">        UC-2000. That setting must be physcially changed on the controller.</span>

<span class="sd">        Enabled checksum means messages are sent with a final checksum byte</span>
<span class="sd">        used to better handle errors with serial communication. Details on the</span>
<span class="sd">        checksum byte and other message formats can be found in the </span>
<span class="sd">        &quot;Message.py&quot; class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checksum</span> <span class="o">=</span> <span class="n">check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return estimated maximum output optical power of the laser based on the model and the max_pwm setting in Watts.&quot;&quot;&quot;</span>
        <span class="n">est_max_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">est_max_power</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return current estimated output optical power of the laser in Watts.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">/</span> <span class="mi">100</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset all UC-2000 settings to default.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: have reset flag such that it forces all the bottom changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;pwm_freq&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;gate_logic&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;max_pwm&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;percent&quot;</span><span class="p">]</span>    <span class="c1"># in percent</span>

    <span class="k">def</span> <span class="nf">_pwm_percent_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit_per</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Limits input PWM percent to (0, 95/99) and converting &#39;63%&#39; to &#39;62.5%&#39;.</span>

<span class="sd">        If input is larger than current max PWM setting then reset to</span>
<span class="sd">        previous PWM percent.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit_per : float</span>
<span class="sd">            Input percent.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        setpoint : float</span>
<span class="sd">            Actual valid setpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if the input percent is an int or float</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">limit_per</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">limit_per</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># make new error here?</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid input percent&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">limit_per</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span><span class="p">:</span>
            <span class="c1"># Set to previous percent</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span>
        <span class="k">elif</span> <span class="n">limit_per</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Set to 0 if negative</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Changes setpoint to be multiple of 0.5</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="n">PERCENT_STEP</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span><span class="n">limit_per</span> <span class="o">/</span> <span class="n">PERCENT_STEP</span><span class="p">)</span>

        <span class="c1"># FIXME: only change this for if checksum if False</span>
        <span class="c1"># Changes setpoint from 63 to 62.5% if checksum mode is disabled</span>
        <span class="k">if</span> <span class="n">setpoint</span> <span class="ow">in</span> <span class="n">PERCENT_TRANSFORMS</span><span class="p">:</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="n">PERCENT_TRANSFORMS</span><span class="p">[</span><span class="n">setpoint</span><span class="p">]</span>
        
        <span class="c1"># TODO: make this to logging instead?</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setpoint is </span><span class="si">{0}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">setpoint</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">setpoint</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_shot_time_limits</span><span class="p">(</span><span class="n">shot</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Limits input shot time to between 50ms to 10s.</span>

<span class="sd">        If oustide the permitted range then the shot time is 50ms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shot : float</span>
<span class="sd">            Input shot time in ms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Valid shot time in ms.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Shot time is the time between the laser ON and OFF state, which can be</span>
<span class="sd">        either:</span>
<span class="sd">            - Turning the command signal between ON and OFF</span>
<span class="sd">            - Setting the PWM command signal percent to the minimum lase value</span>
<span class="sd">            - Switching the Gate signal between HIGH and LOW</span>

<span class="sd">        Currently limited by communication speed between Python script and</span>
<span class="sd">        UC-2000 controller.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">shot</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">shot</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># make new error here?</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid shot time&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shot</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">shot</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">shot</span>

    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shot_percent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">shot_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shoots a laser shot by using PWM percent sequence of LOW, HIGH, LOW.</span>
<span class="sd">        </span>
<span class="sd">        Currently, the low laser percent is 3% as this doesn&#39;t affect the </span>
<span class="sd">        silica glass rods we are using, however, the option can be set in the </span>
<span class="sd">        script above.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shot_percent : float</span>
<span class="sd">            PWM laser percent.</span>
<span class="sd">        shot_time : float</span>
<span class="sd">            Time of shot in ms.</span>
<span class="sd">        num_shots : int</span>
<span class="sd">            Number of consecutive shots</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dict containing average interval time, total time, and any response </span>
<span class="sd">            from UC-2000</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Shot time can be guaranteed but time between shots might be less</span>
<span class="sd">        accurate.</span>

<span class="sd">        If shooting more than once, the time between shots is the same time as </span>
<span class="sd">        the shot time.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; laser = UC2000Controller(model=25)</span>
<span class="sd">        &gt;&gt;&gt; with laser:</span>
<span class="sd">        ...     laser.shoot(10, 500, 2)</span>

<span class="sd">        Fires 2 shots for 500ms at 10% PWM duty cycle percent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shot_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shot_time_limits</span><span class="p">(</span><span class="n">shot_time</span><span class="p">)</span>
        <span class="c1"># Convert shot_time to microseconds</span>
    
        <span class="c1"># operations inside the interval.. Labjack interval ensures that the </span>
        <span class="c1"># percent should be this for the selected shot_time</span>
        <span class="k">def</span> <span class="nf">ops_inside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">shot_percent</span>
            <span class="k">elif</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="c1"># operations outside the interval occur as soon as the host sends the </span>
        <span class="c1"># command to Labjack</span>
        <span class="k">def</span> <span class="nf">ops_outside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="c1"># Interval_number is 2*num_shots - 1 because the operations outside</span>
            <span class="c1"># end the shot so need odd number of iterations to ensure correct </span>
            <span class="c1"># number of shots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">add_interval</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shot_time</span><span class="o">*</span><span class="mf">1e3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_shots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">start_interval</span><span class="p">(</span>
                <span class="n">operations_inside</span><span class="o">=</span><span class="n">ops_inside</span><span class="p">,</span> 
                <span class="n">operations_outside</span><span class="o">=</span><span class="n">ops_outside</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">shot_time</span><span class="p">]</span><span class="o">*</span><span class="n">num_shots</span>
        <span class="k">return</span> <span class="n">interval_metrics</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Parameters for Message object</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># Start transmission byte (STX)</span>
<span class="n">START_BYTE</span> <span class="o">=</span>            <span class="mh">0x5b</span>
<span class="n">STATUS_REQUEST_BYTE</span> <span class="o">=</span>   <span class="mh">0x7e</span>
<span class="n">SET_PERCENT_BYTE</span> <span class="o">=</span>      <span class="mh">0x7f</span>

<span class="n">UC2000_COMMAND_BYTES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;pwm_freq&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">5</span><span class="p">:</span> <span class="mh">0x77</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">:</span> <span class="mh">0x78</span><span class="p">,</span>
        <span class="mi">20</span><span class="p">:</span> <span class="mh">0x7a</span>
    <span class="p">},</span>
    <span class="s2">&quot;gate_logic&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mh">0x7a</span><span class="p">,</span>
        <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mh">0x7b</span>
    <span class="p">},</span>
    <span class="s2">&quot;max_pwm&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="mi">95</span><span class="p">:</span> <span class="mh">0x7c</span><span class="p">,</span>
        <span class="mi">99</span><span class="p">:</span> <span class="mh">0x7d</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="kc">True</span><span class="p">:</span> <span class="mh">0x30</span><span class="p">,</span>
        <span class="kc">False</span><span class="p">:</span> <span class="mh">0x31</span>
    <span class="p">},</span>
    <span class="s2">&quot;mode&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;manual&quot;</span><span class="p">:</span> <span class="mh">0x70</span><span class="p">,</span>
        <span class="s2">&quot;anc&quot;</span><span class="p">:</span> <span class="mh">0x71</span><span class="p">,</span>
        <span class="s2">&quot;anv&quot;</span><span class="p">:</span> <span class="mh">0x72</span><span class="p">,</span>
        <span class="s2">&quot;man_closed&quot;</span><span class="p">:</span> <span class="mh">0x73</span><span class="p">,</span>
        <span class="s2">&quot;anv_closed&quot;</span><span class="p">:</span> <span class="mh">0x74</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;lase&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="kc">True</span><span class="p">:</span> <span class="mh">0x75</span><span class="p">,</span>
        <span class="kc">False</span><span class="p">:</span> <span class="mh">0x76</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Message</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    REMOTE Message sent to UC-2000 on REMOTE mode through RS-232 serial </span>
<span class="sd">    port.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : {&quot;pwm_freq&quot;, &quot;gate_logic&quot;, &quot;max_pwm&quot;, &quot;lase_on_power_up&quot;,</span>
<span class="sd">                &quot;mode&quot;, &quot;lase&quot;, &quot;percent&quot;, &quot;status_request&quot;}</span>
<span class="sd">        Command byte.</span>
<span class="sd">    data : float</span>
<span class="sd">        Data for PWM (or SET for closed loop) command.</span>
<span class="sd">    checksum : bool</span>
<span class="sd">        Checksum protocol mode.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    command</span>
<span class="sd">    data</span>
<span class="sd">    checksum</span>
<span class="sd">    message_bytes</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    add_no_carry(*args)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    There are 5 types of messages with different formats sent;</span>
<span class="sd">        Setup (&quot;pwm_freq&quot;, &quot;gate_logic&quot;, &quot;max_pwm&quot;, &quot;lase_on_power_up&quot;)</span>
<span class="sd">        Mode (&quot;mode&quot;)</span>
<span class="sd">        PWM (or closed loop SET) (&quot;percent&quot;)</span>
<span class="sd">        Lase (&quot;lase&quot;)</span>
<span class="sd">        Status Request</span>

<span class="sd">    Setup Mode, and Lase commands have the byte sequence:</span>
<span class="sd">        STX&lt;Command&gt;&lt;Checksum&gt;</span>
<span class="sd">        STX - start transmission byte.</span>
<span class="sd">        The checksum byte is the one&#39;s compliment of the Command byte.</span>

<span class="sd">    PWM (or SET) command byte sequence:</span>
<span class="sd">        STX&lt;Command&gt;&lt;Data Byte&gt;&lt;Checksum&gt;</span>
<span class="sd">        Data byte is the PWM percentage multipled by 2, converted into hex.</span>
<span class="sd">        The checksum byte is the adding without carry between command and</span>
<span class="sd">        data byte and then performing the one&#39;s compliment.</span>

<span class="sd">    Response from Setup, Mode, Lase, and PWM is either ACK (0xAA) or NAK</span>
<span class="sd">    (0x3F). A NAK is sent if there is no valid command or checksum byte</span>
<span class="sd">    sent within 1s of STX byte or if the checksum byte is wrong.</span>

<span class="sd">    Status Request:</span>
<span class="sd">        Single byte to tell UC-2000 to report it&#39;s status.</span>
<span class="sd">    </span>
<span class="sd">    Response from Status Request is</span>
<span class="sd">        ACK&lt;Status Byte1&gt;&lt;Status Byte2&gt;&lt;PWM Byte&gt;&lt;Power Byte&gt;&lt;Checksum&gt;</span>
<span class="sd">        Refer to the UC-2000 manual for futher details about the contents</span>
<span class="sd">        of the response bytes. Currently not using so not as important.</span>

<span class="sd">    TODO: include parsing response byte from UC-2000</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; message = Message(&quot;percent&quot;, 10, False)</span>
<span class="sd">    &gt;&gt;&gt; message.message_bytes()</span>
<span class="sd">    [126, 127, 20]</span>

<span class="sd">    Create message for setting PWM percent to 10%.</span>

<span class="sd">    &gt;&gt;&gt; message = Message(&quot;lase&quot;, True, False)</span>
<span class="sd">    &gt;&gt;&gt; message.message_bytes()</span>
<span class="sd">    [126, 127, 117]</span>

<span class="sd">    Create message for turning on command signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">checksum</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a Message object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and returns REMOTE message byte sequence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        message : list of int</span>
<span class="sd">            The message sequence containing the start byte, command byte, </span>
<span class="sd">            [data byte (optional)], and checksum (optional)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="n">UC2000_COMMAND_BYTES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">command_byte</span> <span class="o">=</span> <span class="n">UC2000_COMMAND_BYTES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

            <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_BYTE</span><span class="p">,</span> <span class="n">command_byte</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
                <span class="c1"># without data, the checksum is the one&#39;s compliment of the </span>
                <span class="c1"># command byte</span>
                <span class="n">checksum_byte</span> <span class="o">=</span> <span class="o">~</span><span class="n">command_byte</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
                <span class="n">message</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checksum_byte</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;percent&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_BYTE</span><span class="p">,</span> <span class="n">SET_PERCENT_BYTE</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type of data is invalid. Needs to be float or int.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
                <span class="c1"># with data, the checksum is the addition without carry of the </span>
                <span class="c1"># command and data byte and then one&#39;s complimented</span>
                <span class="n">checksum_byte</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">add_no_carry</span><span class="p">(</span><span class="n">SET_PERCENT_BYTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
                    <span class="p">)</span>
                <span class="n">message</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checksum_byte</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;status_request&quot;</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">STATUS_REQUEST_BYTE</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Command is not recognised by UC-2000&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_no_carry</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Addition without carry; addition is not carried to the next decimal up.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : iterable (not string)</span>
<span class="sd">            Iterate of ints to add without carry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        final_sum : int</span>
<span class="sd">            the result...</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 1)</span>
<span class="sd">        2</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 18)</span>
<span class="sd">        19</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 19)</span>
<span class="sd">        10</span>

<span class="sd">        The &#39;10&#39; is not carried over to the next decimal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_digits</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">num_digits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span>
        
        <span class="n">max_digits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">num_digits</span><span class="p">)</span> 
        <span class="c1"># list comprehension way</span>
        <span class="c1"># max_digits = max([len(str(arg)) for arg in args])</span>
        <span class="n">final_sum</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">pwr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_digits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># iterate through ea decimal</span>
            <span class="n">result_no_carry</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">pwr</span><span class="p">:</span>
                    <span class="c1"># modulus sets the current decimal as the most significant </span>
                    <span class="c1"># decimal</span>
                    <span class="c1"># floor div selects the most significant decimal</span>
                    <span class="n">result_no_carry</span> <span class="o">+=</span> <span class="n">arg</span> <span class="o">%</span> <span class="mi">10</span><span class="o">**</span><span class="n">pwr</span> <span class="o">//</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">pwr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    
            <span class="c1"># list comprehension way</span>
            <span class="c1"># result_no_carry = sum([arg % 10**pwr // 10**(pwr - 1) for arg in args if len(str(arg)) &gt;= pwr])</span>
            
            <span class="c1"># final_sum = str(result_no_carry % 10) + final_sum</span>
            <span class="n">final_sum</span> <span class="o">+=</span> <span class="n">result_no_carry</span> <span class="o">%</span> <span class="mi">10</span>
            
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">final_sum</span><span class="p">)</span>
</pre></div>

            </details>

            </section>
                <section id="UC2000Controller">
                                        <div class="attr class">
            
            <span class="def">class</span>
            <span class="name">UC2000Controller</span>:
        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">UC2000Controller</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An interface to SYNRAD 48 series CO2 lasers through UC-2000 controller.  </span>

<span class="sd">    Communication to the UC-2000 controller from a host using REMOTE  </span>
<span class="sd">    settings are facilitated through the Serial RS-232 protocol and port.  </span>

<span class="sd">    Parameters  </span>
<span class="sd">    ----------  </span>
<span class="sd">    model : {25, 50}  </span>
<span class="sd">        SYNRAD 48 series laser model number, indicates the maximum  </span>
<span class="sd">        optical power output  </span>
<span class="sd">    open_labjack : LabJack object  </span>
<span class="sd">        A LabJack object to transmit messages to the UC-2000,  </span>
<span class="sd">        by default False.  </span>

<span class="sd">    Attributes  </span>
<span class="sd">    ----------  </span>
<span class="sd">    lase  </span>
<span class="sd">    percent  </span>
<span class="sd">    pwm_freq  </span>
<span class="sd">    gate_logic  </span>
<span class="sd">    max_pwm  </span>
<span class="sd">    lase_on_power_up  </span>
<span class="sd">    mode  </span>
<span class="sd">    checksum  </span>
<span class="sd">    max_power  </span>
<span class="sd">    power  </span>
<span class="sd">    model  </span>
<span class="sd">    open_labjack  </span>
<span class="sd">    PARAMETER_NAME_hist : list  </span>
<span class="sd">        Entire history of previous PARAMETER_NAME from instantiation.  </span>

<span class="sd">    Methods  </span>
<span class="sd">    -------  </span>
<span class="sd">    reset()  </span>
<span class="sd">        Reset all UC-2000 to default.  </span>
<span class="sd">    shoot(shot_percent, shot_time, num_shots)  </span>
<span class="sd">        Fires a number of shots of a given optical power percent for a   </span>
<span class="sd">        given time.  </span>

<span class="sd">    Notes  </span>
<span class="sd">    -----  </span>
<span class="sd">    Pins 2, 3, and 5 of a serial port are used for receive, transmit, and   </span>
<span class="sd">    ground respectively.  </span>
<span class="sd">    The host serial port configuration must be  </span>
<span class="sd">        Baud rate       9600  </span>
<span class="sd">        Data bits       8 bits  </span>
<span class="sd">        Parity          None  </span>
<span class="sd">        Stop bits       1 bit  </span>
<span class="sd">        Flow control    None  </span>

<span class="sd">    For further details please refer to:  </span>
<span class="sd">    https://synrad.com/en/products/accessories/uc-2000  </span>

<span class="sd">    Messages are sent to the UC-2000 from the host via a DAQ, in this case  </span>
<span class="sd">    a LabJack T4/T7 is used. However, any source that can produce RS-232   </span>
<span class="sd">    asynchronous communication can be used. If a Labjack object or no other  </span>
<span class="sd">    DAQ is provided then the UC-2000 only stores messages.  </span>

<span class="sd">    TODO: LUA scripting - call script to improve timings  </span>
<span class="sd">    TODO: gate pull-up/down, SYNRAD doesn&#39;t know whether gate or comamnd signal activate lasing is faster. Trial and error?  </span>

<span class="sd">    TODO: receiving communication from the labjack... or using the UC2000 response  </span>
<span class="sd">        if check_ack:  </span>
<span class="sd">            daq_response = daq_stats[&quot;response&quot;]  </span>

<span class="sd">            if not isinstance(daq_response, list):  </span>
<span class="sd">                daq_response = [daq_response]  </span>

<span class="sd">            if UC2000_RESPONSE[&quot;ack&quot;] in daq_response:  </span>
<span class="sd">                self.laser_controller.set_any(setting, option)  </span>
<span class="sd">                gui_message = &quot;\&quot;{0}\&quot; has changed to \&quot;{1}\&quot;&quot;.format(setting, option)  </span>
<span class="sd">                action = &quot;continue&quot;  </span>
<span class="sd">                outcome = option  </span>
<span class="sd">            elif UC2000_RESPONSE[&quot;nak&quot;] in daq_response:  </span>
<span class="sd">                gui_message = &quot;\&quot;{0}\&quot; remains unchanged as {1} because UC2000 didn&#39;t accept the message&quot;.format(setting, prev)  </span>
<span class="sd">                action = &quot;previous&quot;  </span>
<span class="sd">                outcome = prev  </span>
<span class="sd">            else:</span>
<span class="sd">                gui_message = &quot;Setting \&quot;{0}\&quot; remains unchanged as {1} because there has been no response from UC2000&quot;.format(setting, prev)  </span>
<span class="sd">                action = &quot;previous&quot;  </span>
<span class="sd">                outcome = prev  </span>
<span class="sd">        else:  </span>
<span class="sd">            self.laser_controller.set_any(setting, option)  </span>
<span class="sd">            gui_message = &quot;Setting \&quot;{0}\&quot; has changed to \&quot;{1}\&quot;&quot;.format(setting, option)  </span>
<span class="sd">            action = &quot;continue&quot;  </span>
<span class="sd">            outcome = option  </span>

<span class="sd">    TODO: test with slightly longer wait time between asynch communications  </span>
<span class="sd">    TODO: can send remote status byte inbetween start and end transmission byte of any other  </span>
<span class="sd">    command - maybe use to check option on laser  </span>

<span class="sd">    Examples  </span>
<span class="sd">    --------  </span>
<span class="sd">    &gt;&gt;&gt; laser = UC2000Controller(model=25)  </span>
<span class="sd">    &gt;&gt;&gt; with laser:  </span>
<span class="sd">    ...     laser.percent = 20  </span>
<span class="sd">    ...     laser.lase = True  </span>
<span class="sd">    ...     laser.percent = 0  </span>
<span class="sd">    ...     laser.lase = False  </span>

<span class="sd">    Demonstration of the .percent and .lase commands  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">open_labjack</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a UC2000 object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span> <span class="o">=</span> <span class="n">open_labjack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum_hist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Assumes that Checksum mode is enabled... </span>
        <span class="c1"># and why would we not use checksum mode anyways</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="kc">True</span>      

        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Laser process stopped by user&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># returning False because we want to allow nested with statements </span>
            <span class="c1"># above the stack to also use their __exit__ which turns the laser</span>
            <span class="c1"># off and low set percent.</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># turn it down anyways</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return lase state.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lase</span>
    
    <span class="nd">@lase</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set lase state to either True or False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : bool</span>
<span class="sd">            New set lase state.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Lase state is controlled by a Command signal for LOW (0 - 0.5V DC) </span>
<span class="sd">        and HIGH (3.5 - 5V DC).</span>

<span class="sd">        When the Command signal is low for &gt;200us, the UC-2000 always supplies </span>
<span class="sd">        laser with 5kHz, 1us tickle pulse that pre-ionises the laser gas to </span>
<span class="sd">        just below lasing threshold. Any increase in pulse width causes </span>
<span class="sd">        emission as enough energy is added to the plasma.</span>

<span class="sd">        If a labjack is connected, then a LASE message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lase</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># if the new option is the same as before don&#39;t send changes to labjack</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;lase&quot;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return laser percent, representing the PWM signal duty cycle percentage.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_percent</span>

    <span class="nd">@percent</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">per</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set laser percent (PWM signal duty cycle percentage), limited to </span>
<span class="sd">        between 0 and 95/99% in steps of 0.5%.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        per : float</span>
<span class="sd">            New PWM duty cycle percentage, in seteps of 0.5%</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The laser percent defaults to previous percent if new percent is </span>
<span class="sd">        outside of the permitted range. If self.checksum flag is True, then the</span>
<span class="sd">        set laser percent cannot be 63% defaults to 62.5% instead.</span>

<span class="sd">        The PWM signal duty cycle controls how much of the Command signal&#39;s </span>
<span class="sd">        pulse is HIGH. When the Command signal is HIGH, the laser RF amplifiers </span>
<span class="sd">        are HIGH and this increases the optical output power.</span>

<span class="sd">        If a labjack is connected, then a SET message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">per</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_percent_limits</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_percent</span> <span class="o">=</span> <span class="n">per</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;percent&quot;</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pwm_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return laser PWM frequency.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_freq</span>

    <span class="nd">@pwm_freq</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pwm_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set laser PWM frequency to either 5, 10, or 20kHz.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        freq : {5, 10, 20}</span>
<span class="sd">            New laser percent.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The PWM frequency of the Command signal, where the laser optical output </span>
<span class="sd">        follows the Command signal with a rise/fall time of 75-150us. A higher </span>
<span class="sd">        PWM frequency means the laser output response has less ripple and at </span>
<span class="sd">        20kHz the laser output is nearly CW with small ripple.</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pwm_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">freq</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;pwm_freq&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gate_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return gate pull up/down status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gate_logic</span>
    
    <span class="nd">@gate_logic</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gate_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pull</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set gate pull up/down status to either pull &quot;up&quot; or &quot;down&quot;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pull : {&quot;up&quot;, &quot;down&quot;}</span>
<span class="sd">            New gate pull status.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Gate pull up indicates that the laser will fire without a gate signal.</span>
<span class="sd">        This means the UC-2000 connects an internal resistor between the gate</span>
<span class="sd">        and command signal.</span>

<span class="sd">        Gate pull down means the laser will fire when the gate signal is HIGH </span>
<span class="sd">        and the command signal is HIGH. A gate signal is supplied to the Gate </span>
<span class="sd">        BNC input and is either logic LOW (0 - 0.9V DC) or HIGH (2.8 - 5 V DC). </span>
<span class="sd">        Now, the tickle pulse and command signals are determined by the </span>
<span class="sd">        Gating amplitude.</span>

<span class="sd">        Note: PWM and gate pulses are not asynchronous, the edges of both </span>
<span class="sd">        pulses are not synchronised.</span>

<span class="sd">        Input impedence: 50 kOhms</span>
<span class="sd">        Gate On Time, min: 3.5us (10ms in closed loop mode)/</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gate_logic</span> <span class="o">=</span> <span class="n">pull</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pull</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pull</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;gate_logic&quot;</span><span class="p">,</span> <span class="n">pull</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the maximum PWM perentage or maximum duty cycle time.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_pwm</span>

    <span class="nd">@max_pwm</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">max_pwm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">per</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the maximum PWM percentage of the Command signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        per : {95, 99}</span>
<span class="sd">            New max PWM percentage.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        SYNRAD lasers have max PWM percentage of 95% by default to increase</span>
<span class="sd">        longevity of lasers as greater than 95% increases heat load and &quot;may</span>
<span class="sd">        cause thermal instability and optical degradation.&quot;</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_pwm</span> <span class="o">=</span> <span class="n">per</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;max_pwm&quot;</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lase_on_power_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return lase on power-up status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lase_on_power_up</span>
    
    <span class="nd">@lase_on_power_up</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lase_on_power_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set lase on power-up status to either True or False.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pwr : bool</span>
<span class="sd">            New lase on power-up setting.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If the lase on power-up status is ON, then the UC-2000 controller will</span>
<span class="sd">        send a lase signal immediately when the power is turned on. Used only</span>
<span class="sd">        when access to UC-2000 controller is limited.</span>

<span class="sd">        If a labjack is connected, then a SETUP message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lase_on_power_up</span> <span class="o">=</span> <span class="n">pwr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pwr</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">,</span> <span class="n">pwr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return UC-2000 operating mode.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span>

    <span class="nd">@mode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set UC-2000 operating mode to 5 possible choices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode_type : {&quot;manual&quot;, &quot;anc&quot;, &quot;anv&quot; &quot;man_closed&quot;, &quot;anv_closed&quot;}</span>
<span class="sd">            New operating mode.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        MANUAL (&quot;manual&quot;)</span>
<span class="sd">        Laser output power is adjusted by the PWM command signal duty cycle</span>
<span class="sd">        percentage.</span>

<span class="sd">        ANC (&quot;anc&quot;)</span>
<span class="sd">        Laser power controlled by external 4-20mA current loop. PWM duty cycle</span>
<span class="sd">        changes proportionally to applied current.</span>

<span class="sd">        ANV (&quot;anv&quot;)</span>
<span class="sd">        Laser power controlled by external analog 0-10V source where the duty </span>
<span class="sd">        cycle is proportional to external voltage.</span>

<span class="sd">        MAN. CLOSED (&quot;man_closed&quot;)</span>
<span class="sd">        Closed loop power is ensured by Closed Loop Stablization Kit which</span>
<span class="sd">        regulates power stability to within +/-2% of the setpoint. Closed loop</span>
<span class="sd">        settling time is typically 2ms after setpoint change. The recommended</span>
<span class="sd">        lower and upper control range is 20-80% PWM duty cycle percent.</span>

<span class="sd">        ANV CLOSED (&quot;anv_closed&quot;)</span>
<span class="sd">        Similar to MAN. CLOSED except an external analog voltage is stabilised.</span>

<span class="sd">        If a labjack is connected, then a MODE message will be sent to the </span>
<span class="sd">        UC2000.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mode_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">mode_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span><span class="o">.</span><span class="n">message_bytes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">asynch</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return checksum protocol use.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checksum</span>

    <span class="nd">@checksum</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set checksum protocol used for commands sent through the RS-232 protocol.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : bool</span>
<span class="sd">            New checksum enable or disable option.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Only changes the message sent by Python and not the message sent by the</span>
<span class="sd">        UC-2000. That setting must be physcially changed on the controller.</span>

<span class="sd">        Enabled checksum means messages are sent with a final checksum byte</span>
<span class="sd">        used to better handle errors with serial communication. Details on the</span>
<span class="sd">        checksum byte and other message formats can be found in the </span>
<span class="sd">        &quot;Message.py&quot; class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checksum</span> <span class="o">=</span> <span class="n">check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return estimated maximum output optical power of the laser based on the model and the max_pwm setting in Watts.&quot;&quot;&quot;</span>
        <span class="n">est_max_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">est_max_power</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return current estimated output optical power of the laser in Watts.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">/</span> <span class="mi">100</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset all UC-2000 settings to default.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: have reset flag such that it forces all the bottom changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;pwm_freq&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;gate_logic&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;max_pwm&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;percent&quot;</span><span class="p">]</span>    <span class="c1"># in percent</span>

    <span class="k">def</span> <span class="nf">_pwm_percent_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit_per</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Limits input PWM percent to (0, 95/99) and converting &#39;63%&#39; to &#39;62.5%&#39;.</span>

<span class="sd">        If input is larger than current max PWM setting then reset to</span>
<span class="sd">        previous PWM percent.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        limit_per : float</span>
<span class="sd">            Input percent.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        setpoint : float</span>
<span class="sd">            Actual valid setpoint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if the input percent is an int or float</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">limit_per</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">limit_per</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># make new error here?</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid input percent&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">limit_per</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span><span class="p">:</span>
            <span class="c1"># Set to previous percent</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent</span>
        <span class="k">elif</span> <span class="n">limit_per</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Set to 0 if negative</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Changes setpoint to be multiple of 0.5</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="n">PERCENT_STEP</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span><span class="n">limit_per</span> <span class="o">/</span> <span class="n">PERCENT_STEP</span><span class="p">)</span>

        <span class="c1"># FIXME: only change this for if checksum if False</span>
        <span class="c1"># Changes setpoint from 63 to 62.5% if checksum mode is disabled</span>
        <span class="k">if</span> <span class="n">setpoint</span> <span class="ow">in</span> <span class="n">PERCENT_TRANSFORMS</span><span class="p">:</span>
            <span class="n">setpoint</span> <span class="o">=</span> <span class="n">PERCENT_TRANSFORMS</span><span class="p">[</span><span class="n">setpoint</span><span class="p">]</span>
        
        <span class="c1"># TODO: make this to logging instead?</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setpoint is </span><span class="si">{0}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">setpoint</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">setpoint</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_shot_time_limits</span><span class="p">(</span><span class="n">shot</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Limits input shot time to between 50ms to 10s.</span>

<span class="sd">        If oustide the permitted range then the shot time is 50ms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shot : float</span>
<span class="sd">            Input shot time in ms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Valid shot time in ms.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Shot time is the time between the laser ON and OFF state, which can be</span>
<span class="sd">        either:</span>
<span class="sd">            - Turning the command signal between ON and OFF</span>
<span class="sd">            - Setting the PWM command signal percent to the minimum lase value</span>
<span class="sd">            - Switching the Gate signal between HIGH and LOW</span>

<span class="sd">        Currently limited by communication speed between Python script and</span>
<span class="sd">        UC-2000 controller.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">shot</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">shot</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># make new error here?</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid shot time&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shot</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">shot</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">SHOT_TIME_RANGE</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">shot</span>

    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shot_percent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">shot_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shoots a laser shot by using PWM percent sequence of LOW, HIGH, LOW.</span>
<span class="sd">        </span>
<span class="sd">        Currently, the low laser percent is 3% as this doesn&#39;t affect the </span>
<span class="sd">        silica glass rods we are using, however, the option can be set in the </span>
<span class="sd">        script above.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shot_percent : float</span>
<span class="sd">            PWM laser percent.</span>
<span class="sd">        shot_time : float</span>
<span class="sd">            Time of shot in ms.</span>
<span class="sd">        num_shots : int</span>
<span class="sd">            Number of consecutive shots</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dict containing average interval time, total time, and any response </span>
<span class="sd">            from UC-2000</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Shot time can be guaranteed but time between shots might be less</span>
<span class="sd">        accurate.</span>

<span class="sd">        If shooting more than once, the time between shots is the same time as </span>
<span class="sd">        the shot time.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; laser = UC2000Controller(model=25)</span>
<span class="sd">        &gt;&gt;&gt; with laser:</span>
<span class="sd">        ...     laser.shoot(10, 500, 2)</span>

<span class="sd">        Fires 2 shots for 500ms at 10% PWM duty cycle percent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shot_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shot_time_limits</span><span class="p">(</span><span class="n">shot_time</span><span class="p">)</span>
        <span class="c1"># Convert shot_time to microseconds</span>
    
        <span class="c1"># operations inside the interval.. Labjack interval ensures that the </span>
        <span class="c1"># percent should be this for the selected shot_time</span>
        <span class="k">def</span> <span class="nf">ops_inside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">shot_percent</span>
            <span class="k">elif</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="c1"># operations outside the interval occur as soon as the host sends the </span>
        <span class="c1"># command to Labjack</span>
        <span class="k">def</span> <span class="nf">ops_outside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="c1"># Interval_number is 2*num_shots - 1 because the operations outside</span>
            <span class="c1"># end the shot so need odd number of iterations to ensure correct </span>
            <span class="c1"># number of shots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">add_interval</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shot_time</span><span class="o">*</span><span class="mf">1e3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_shots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">start_interval</span><span class="p">(</span>
                <span class="n">operations_inside</span><span class="o">=</span><span class="n">ops_inside</span><span class="p">,</span> 
                <span class="n">operations_outside</span><span class="o">=</span><span class="n">ops_outside</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">shot_time</span><span class="p">]</span><span class="o">*</span><span class="n">num_shots</span>
        <span class="k">return</span> <span class="n">interval_metrics</span>
</pre></div>

            </details>

                    <div class="docstring"><p>An interface to SYNRAD 48 series CO2 lasers through UC-2000 controller.  </p>

<p>Communication to the UC-2000 controller from a host using REMOTE <br />
settings are facilitated through the Serial RS-232 protocol and port.  </p>

<h2 id="parameters">Parameters  </h2>

<p>model : {25, 50} <br />
    SYNRAD 48 series laser model number, indicates the maximum <br />
    optical power output <br />
open_labjack : LabJack object <br />
    A LabJack object to transmit messages to the UC-2000, <br />
    by default False.  </p>

<h2 id="attributes">Attributes  </h2>

<p>lase <br />
percent <br />
pwm_freq <br />
gate_logic <br />
max_pwm <br />
lase_on_power_up <br />
mode <br />
checksum <br />
max_power <br />
power <br />
model <br />
open_labjack <br />
PARAMETER_NAME_hist : list <br />
    Entire history of previous PARAMETER_NAME from instantiation.  </p>

<h2 id="methods">Methods  </h2>

<p>reset() <br />
    Reset all UC-2000 to default. <br />
shoot(shot_percent, shot_time, num_shots) <br />
    Fires a number of shots of a given optical power percent for a <br />
    given time.  </p>

<h2 id="notes">Notes  </h2>

<p>Pins 2, 3, and 5 of a serial port are used for receive, transmit, and <br />
ground respectively. <br />
The host serial port configuration must be <br />
    Baud rate       9600 <br />
    Data bits       8 bits <br />
    Parity          None <br />
    Stop bits       1 bit <br />
    Flow control    None  </p>

<p>For further details please refer to: <br />
https://synrad.com/en/products/accessories/uc-2000  </p>

<p>Messages are sent to the UC-2000 from the host via a DAQ, in this case <br />
a LabJack T4/T7 is used. However, any source that can produce RS-232 <br />
asynchronous communication can be used. If a Labjack object or no other <br />
DAQ is provided then the UC-2000 only stores messages.  </p>

<p>TODO: LUA scripting - call script to improve timings <br />
TODO: gate pull-up/down, SYNRAD doesn't know whether gate or comamnd signal activate lasing is faster. Trial and error?  </p>

<p>TODO: receiving communication from the labjack... or using the UC2000 response <br />
    if check_ack: <br />
        daq_response = daq_stats["response"]  </p>

<pre><code>    if not isinstance(daq_response, list):  
        daq_response = [daq_response]  

    if UC2000_RESPONSE["ack"] in daq_response:  
        self.laser_controller.set_any(setting, option)  
        gui_message = ""{0}" has changed to "{1}"".format(setting, option)  
        action = "continue"  
        outcome = option  
    elif UC2000_RESPONSE["nak"] in daq_response:  
        gui_message = ""{0}" remains unchanged as {1} because UC2000 didn't accept the message".format(setting, prev)  
        action = "previous"  
        outcome = prev  
    else:
        gui_message = "Setting "{0}" remains unchanged as {1} because there has been no response from UC2000".format(setting, prev)  
        action = "previous"  
        outcome = prev  
else:  
    self.laser_controller.set_any(setting, option)  
    gui_message = "Setting "{0}" has changed to "{1}"".format(setting, option)  
    action = "continue"  
    outcome = option
</code></pre>

<p>TODO: test with slightly longer wait time between asynch communications <br />
TODO: can send remote status byte inbetween start and end transmission byte of any other <br />
command - maybe use to check option on laser  </p>

<h2 id="examples">Examples  </h2>

<pre><code>&gt;&gt;&gt; laser = UC2000Controller(model=25)  
&gt;&gt;&gt; with laser:  
...     laser.percent = 20  
...     laser.lase = True  
...     laser.percent = 0  
...     laser.lase = False
</code></pre>

<p>Demonstration of the .percent and .lase commands</p>
</div>


                            <div id="UC2000Controller.__init__" class="classattr">
                                            <div class="attr function">
            
                <span class="name">UC2000Controller</span><span class="signature">(model: int, open_labjack=False)</span>        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">open_labjack</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a UC2000 object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span> <span class="o">=</span> <span class="n">open_labjack</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_hist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum_hist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Assumes that Checksum mode is enabled... </span>
        <span class="c1"># and why would we not use checksum mode anyways</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="kc">True</span>      

        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>

            </details>

                    <div class="docstring"><p>Inits a UC2000 object.</p>
</div>


                            </div>
                            <div id="UC2000Controller.checksum" class="classattr">
                                                    <div class="attr variable">
            <span class="name">checksum</span>
        </div>

                    <div class="docstring"><p>Return checksum protocol use.</p>
</div>


                            </div>
                            <div id="UC2000Controller.lase" class="classattr">
                                                    <div class="attr variable">
            <span class="name">lase</span>
        </div>

                    <div class="docstring"><p>Return lase state.</p>
</div>


                            </div>
                            <div id="UC2000Controller.percent" class="classattr">
                                                    <div class="attr variable">
            <span class="name">percent</span>
        </div>

                    <div class="docstring"><p>Return laser percent, representing the PWM signal duty cycle percentage.</p>
</div>


                            </div>
                            <div id="UC2000Controller.pwm_freq" class="classattr">
                                                    <div class="attr variable">
            <span class="name">pwm_freq</span>
        </div>

                    <div class="docstring"><p>Return laser PWM frequency.</p>
</div>


                            </div>
                            <div id="UC2000Controller.gate_logic" class="classattr">
                                                    <div class="attr variable">
            <span class="name">gate_logic</span>
        </div>

                    <div class="docstring"><p>Return gate pull up/down status.</p>
</div>


                            </div>
                            <div id="UC2000Controller.max_pwm" class="classattr">
                                                    <div class="attr variable">
            <span class="name">max_pwm</span>
        </div>

                    <div class="docstring"><p>Return the maximum PWM perentage or maximum duty cycle time.</p>
</div>


                            </div>
                            <div id="UC2000Controller.lase_on_power_up" class="classattr">
                                                    <div class="attr variable">
            <span class="name">lase_on_power_up</span>
        </div>

                    <div class="docstring"><p>Return lase on power-up status.</p>
</div>


                            </div>
                            <div id="UC2000Controller.mode" class="classattr">
                                                    <div class="attr variable">
            <span class="name">mode</span>
        </div>

                    <div class="docstring"><p>Return UC-2000 operating mode.</p>
</div>


                            </div>
                            <div id="UC2000Controller.max_power" class="classattr">
                                                    <div class="attr variable">
            <span class="name">max_power</span>
        </div>

                    <div class="docstring"><p>Return estimated maximum output optical power of the laser based on the model and the max_pwm setting in Watts.</p>
</div>


                            </div>
                            <div id="UC2000Controller.power" class="classattr">
                                                    <div class="attr variable">
            <span class="name">power</span>
        </div>

                    <div class="docstring"><p>Return current estimated output optical power of the laser in Watts.</p>
</div>


                            </div>
                            <div id="UC2000Controller.reset" class="classattr">
                                            <div class="attr function">
            
                <span class="def">def</span>
                <span class="name">reset</span><span class="signature">(self)</span>:
        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset all UC-2000 settings to default.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: have reset flag such that it forces all the bottom changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwm_freq</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;pwm_freq&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_logic</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;gate_logic&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pwm</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;max_pwm&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase_on_power_up</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase_on_power_up&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;lase&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">UC2000_DEFAULT_SETTINGS</span><span class="p">[</span><span class="s2">&quot;percent&quot;</span><span class="p">]</span>    <span class="c1"># in percent</span>
</pre></div>

            </details>

                    <div class="docstring"><p>Reset all UC-2000 settings to default.</p>
</div>


                            </div>
                            <div id="UC2000Controller.shoot" class="classattr">
                                            <div class="attr function">
            
                <span class="def">def</span>
                <span class="name">shoot</span><span class="signature">(self, shot_percent: float, shot_time: float, num_shots: int)</span>:
        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">shoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shot_percent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">shot_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">num_shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shoots a laser shot by using PWM percent sequence of LOW, HIGH, LOW.</span>
<span class="sd">        </span>
<span class="sd">        Currently, the low laser percent is 3% as this doesn&#39;t affect the </span>
<span class="sd">        silica glass rods we are using, however, the option can be set in the </span>
<span class="sd">        script above.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shot_percent : float</span>
<span class="sd">            PWM laser percent.</span>
<span class="sd">        shot_time : float</span>
<span class="sd">            Time of shot in ms.</span>
<span class="sd">        num_shots : int</span>
<span class="sd">            Number of consecutive shots</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dict containing average interval time, total time, and any response </span>
<span class="sd">            from UC-2000</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Shot time can be guaranteed but time between shots might be less</span>
<span class="sd">        accurate.</span>

<span class="sd">        If shooting more than once, the time between shots is the same time as </span>
<span class="sd">        the shot time.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; laser = UC2000Controller(model=25)</span>
<span class="sd">        &gt;&gt;&gt; with laser:</span>
<span class="sd">        ...     laser.shoot(10, 500, 2)</span>

<span class="sd">        Fires 2 shots for 500ms at 10% PWM duty cycle percent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shot_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shot_time_limits</span><span class="p">(</span><span class="n">shot_time</span><span class="p">)</span>
        <span class="c1"># Convert shot_time to microseconds</span>
    
        <span class="c1"># operations inside the interval.. Labjack interval ensures that the </span>
        <span class="c1"># percent should be this for the selected shot_time</span>
        <span class="k">def</span> <span class="nf">ops_inside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">shot_percent</span>
            <span class="k">elif</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="c1"># operations outside the interval occur as soon as the host sends the </span>
        <span class="c1"># command to Labjack</span>
        <span class="k">def</span> <span class="nf">ops_outside</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
            <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="p">:</span>
            <span class="c1"># Interval_number is 2*num_shots - 1 because the operations outside</span>
            <span class="c1"># end the shot so need odd number of iterations to ensure correct </span>
            <span class="c1"># number of shots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">add_interval</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">shot_time</span><span class="o">*</span><span class="mf">1e3</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_shots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_labjack</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">start_interval</span><span class="p">(</span>
                <span class="n">operations_inside</span><span class="o">=</span><span class="n">ops_inside</span><span class="p">,</span> 
                <span class="n">operations_outside</span><span class="o">=</span><span class="n">ops_outside</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="n">MIN_LASE_PERCENT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shot_time_hist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">shot_time</span><span class="p">]</span><span class="o">*</span><span class="n">num_shots</span>
        <span class="k">return</span> <span class="n">interval_metrics</span>
</pre></div>

            </details>

                    <div class="docstring"><p>Shoots a laser shot by using PWM percent sequence of LOW, HIGH, LOW.</p>

<p>Currently, the low laser percent is 3% as this doesn't affect the 
silica glass rods we are using, however, the option can be set in the 
script above.</p>

<h2 id="parameters">Parameters</h2>

<p>shot_percent : float
    PWM laser percent.
shot_time : float
    Time of shot in ms.
num_shots : int
    Number of consecutive shots</p>

<h2 id="returns">Returns</h2>

<p>dict
    Dict containing average interval time, total time, and any response 
    from UC-2000</p>

<h2 id="notes">Notes</h2>

<p>Shot time can be guaranteed but time between shots might be less
accurate.</p>

<p>If shooting more than once, the time between shots is the same time as 
the shot time.</p>

<h2 id="examples">Examples</h2>

<pre><code>&gt;&gt;&gt; laser = UC2000Controller(model=25)
&gt;&gt;&gt; with laser:
...     laser.shoot(10, 500, 2)
</code></pre>

<p>Fires 2 shots for 500ms at 10% PWM duty cycle percent.</p>
</div>


                            </div>
                </section>
                <section id="Message">
                                        <div class="attr class">
            
            <span class="def">class</span>
            <span class="name">Message</span>:
        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Message</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    REMOTE Message sent to UC-2000 on REMOTE mode through RS-232 serial </span>
<span class="sd">    port.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : {&quot;pwm_freq&quot;, &quot;gate_logic&quot;, &quot;max_pwm&quot;, &quot;lase_on_power_up&quot;,</span>
<span class="sd">                &quot;mode&quot;, &quot;lase&quot;, &quot;percent&quot;, &quot;status_request&quot;}</span>
<span class="sd">        Command byte.</span>
<span class="sd">    data : float</span>
<span class="sd">        Data for PWM (or SET for closed loop) command.</span>
<span class="sd">    checksum : bool</span>
<span class="sd">        Checksum protocol mode.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    command</span>
<span class="sd">    data</span>
<span class="sd">    checksum</span>
<span class="sd">    message_bytes</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    add_no_carry(*args)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    There are 5 types of messages with different formats sent;</span>
<span class="sd">        Setup (&quot;pwm_freq&quot;, &quot;gate_logic&quot;, &quot;max_pwm&quot;, &quot;lase_on_power_up&quot;)</span>
<span class="sd">        Mode (&quot;mode&quot;)</span>
<span class="sd">        PWM (or closed loop SET) (&quot;percent&quot;)</span>
<span class="sd">        Lase (&quot;lase&quot;)</span>
<span class="sd">        Status Request</span>

<span class="sd">    Setup Mode, and Lase commands have the byte sequence:</span>
<span class="sd">        STX&lt;Command&gt;&lt;Checksum&gt;</span>
<span class="sd">        STX - start transmission byte.</span>
<span class="sd">        The checksum byte is the one&#39;s compliment of the Command byte.</span>

<span class="sd">    PWM (or SET) command byte sequence:</span>
<span class="sd">        STX&lt;Command&gt;&lt;Data Byte&gt;&lt;Checksum&gt;</span>
<span class="sd">        Data byte is the PWM percentage multipled by 2, converted into hex.</span>
<span class="sd">        The checksum byte is the adding without carry between command and</span>
<span class="sd">        data byte and then performing the one&#39;s compliment.</span>

<span class="sd">    Response from Setup, Mode, Lase, and PWM is either ACK (0xAA) or NAK</span>
<span class="sd">    (0x3F). A NAK is sent if there is no valid command or checksum byte</span>
<span class="sd">    sent within 1s of STX byte or if the checksum byte is wrong.</span>

<span class="sd">    Status Request:</span>
<span class="sd">        Single byte to tell UC-2000 to report it&#39;s status.</span>
<span class="sd">    </span>
<span class="sd">    Response from Status Request is</span>
<span class="sd">        ACK&lt;Status Byte1&gt;&lt;Status Byte2&gt;&lt;PWM Byte&gt;&lt;Power Byte&gt;&lt;Checksum&gt;</span>
<span class="sd">        Refer to the UC-2000 manual for futher details about the contents</span>
<span class="sd">        of the response bytes. Currently not using so not as important.</span>

<span class="sd">    TODO: include parsing response byte from UC-2000</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; message = Message(&quot;percent&quot;, 10, False)</span>
<span class="sd">    &gt;&gt;&gt; message.message_bytes()</span>
<span class="sd">    [126, 127, 20]</span>

<span class="sd">    Create message for setting PWM percent to 10%.</span>

<span class="sd">    &gt;&gt;&gt; message = Message(&quot;lase&quot;, True, False)</span>
<span class="sd">    &gt;&gt;&gt; message.message_bytes()</span>
<span class="sd">    [126, 127, 117]</span>

<span class="sd">    Create message for turning on command signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">checksum</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a Message object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and returns REMOTE message byte sequence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        message : list of int</span>
<span class="sd">            The message sequence containing the start byte, command byte, </span>
<span class="sd">            [data byte (optional)], and checksum (optional)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="n">UC2000_COMMAND_BYTES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">command_byte</span> <span class="o">=</span> <span class="n">UC2000_COMMAND_BYTES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

            <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_BYTE</span><span class="p">,</span> <span class="n">command_byte</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
                <span class="c1"># without data, the checksum is the one&#39;s compliment of the </span>
                <span class="c1"># command byte</span>
                <span class="n">checksum_byte</span> <span class="o">=</span> <span class="o">~</span><span class="n">command_byte</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
                <span class="n">message</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checksum_byte</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;percent&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">START_BYTE</span><span class="p">,</span> <span class="n">SET_PERCENT_BYTE</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type of data is invalid. Needs to be float or int.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">:</span>
                <span class="c1"># with data, the checksum is the addition without carry of the </span>
                <span class="c1"># command and data byte and then one&#39;s complimented</span>
                <span class="n">checksum_byte</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">add_no_carry</span><span class="p">(</span><span class="n">SET_PERCENT_BYTE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
                    <span class="p">)</span>
                <span class="n">message</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checksum_byte</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;status_request&quot;</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">STATUS_REQUEST_BYTE</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Command is not recognised by UC-2000&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_no_carry</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Addition without carry; addition is not carried to the next decimal up.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : iterable (not string)</span>
<span class="sd">            Iterate of ints to add without carry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        final_sum : int</span>
<span class="sd">            the result...</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 1)</span>
<span class="sd">        2</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 18)</span>
<span class="sd">        19</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 19)</span>
<span class="sd">        10</span>

<span class="sd">        The &#39;10&#39; is not carried over to the next decimal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_digits</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">num_digits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span>
        
        <span class="n">max_digits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">num_digits</span><span class="p">)</span> 
        <span class="c1"># list comprehension way</span>
        <span class="c1"># max_digits = max([len(str(arg)) for arg in args])</span>
        <span class="n">final_sum</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">pwr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_digits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># iterate through ea decimal</span>
            <span class="n">result_no_carry</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">pwr</span><span class="p">:</span>
                    <span class="c1"># modulus sets the current decimal as the most significant </span>
                    <span class="c1"># decimal</span>
                    <span class="c1"># floor div selects the most significant decimal</span>
                    <span class="n">result_no_carry</span> <span class="o">+=</span> <span class="n">arg</span> <span class="o">%</span> <span class="mi">10</span><span class="o">**</span><span class="n">pwr</span> <span class="o">//</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">pwr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    
            <span class="c1"># list comprehension way</span>
            <span class="c1"># result_no_carry = sum([arg % 10**pwr // 10**(pwr - 1) for arg in args if len(str(arg)) &gt;= pwr])</span>
            
            <span class="c1"># final_sum = str(result_no_carry % 10) + final_sum</span>
            <span class="n">final_sum</span> <span class="o">+=</span> <span class="n">result_no_carry</span> <span class="o">%</span> <span class="mi">10</span>
            
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">final_sum</span><span class="p">)</span>
</pre></div>

            </details>

                    <div class="docstring"><p>REMOTE Message sent to UC-2000 on REMOTE mode through RS-232 serial 
port.</p>

<h2 id="parameters">Parameters</h2>

<p>command : {"pwm_freq", "gate_logic", "max_pwm", "lase_on_power_up",
            "mode", "lase", "percent", "status_request"}
    Command byte.
data : float
    Data for PWM (or SET for closed loop) command.
checksum : bool
    Checksum protocol mode.</p>

<h2 id="attributes">Attributes</h2>

<p>command
data
checksum
message_bytes</p>

<h2 id="methods">Methods</h2>

<p>add_no_carry(*args)</p>

<h2 id="notes">Notes</h2>

<p>There are 5 types of messages with different formats sent;
    Setup ("pwm_freq", "gate_logic", "max_pwm", "lase_on_power_up")
    Mode ("mode")
    PWM (or closed loop SET) ("percent")
    Lase ("lase")
    Status Request</p>

<p>Setup Mode, and Lase commands have the byte sequence:
    STX<Command><Checksum>
    STX - start transmission byte.
    The checksum byte is the one's compliment of the Command byte.</p>

<p>PWM (or SET) command byte sequence:
    STX<Command><Data Byte><Checksum>
    Data byte is the PWM percentage multipled by 2, converted into hex.
    The checksum byte is the adding without carry between command and
    data byte and then performing the one's compliment.</p>

<p>Response from Setup, Mode, Lase, and PWM is either ACK (0xAA) or NAK
(0x3F). A NAK is sent if there is no valid command or checksum byte
sent within 1s of STX byte or if the checksum byte is wrong.</p>

<p>Status Request:
    Single byte to tell UC-2000 to report it's status.</p>

<p>Response from Status Request is
    ACK<Status Byte1><Status Byte2><PWM Byte><Power Byte><Checksum>
    Refer to the UC-2000 manual for futher details about the contents
    of the response bytes. Currently not using so not as important.</p>

<p>TODO: include parsing response byte from UC-2000</p>

<h2 id="examples">Examples</h2>

<pre><code>&gt;&gt;&gt; message = Message("percent", 10, False)
&gt;&gt;&gt; message.message_bytes()
[126, 127, 20]
</code></pre>

<p>Create message for setting PWM percent to 10%.</p>

<pre><code>&gt;&gt;&gt; message = Message("lase", True, False)
&gt;&gt;&gt; message.message_bytes()
[126, 127, 117]
</code></pre>

<p>Create message for turning on command signal.</p>
</div>


                            <div id="Message.__init__" class="classattr">
                                            <div class="attr function">
            
                <span class="name">Message</span><span class="signature">(command: str, data, checksum: bool)</span>        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">checksum</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits a Message object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</pre></div>

            </details>

                    <div class="docstring"><p>Inits a Message object.</p>
</div>


                            </div>
                            <div id="Message.message_bytes" class="classattr">
                                                    <div class="attr variable">
            <span class="name">message_bytes</span>
        </div>

                    <div class="docstring"><p>Creates and returns REMOTE message byte sequence.</p>

<h2 id="returns">Returns</h2>

<p>message : list of int
    The message sequence containing the start byte, command byte, 
    [data byte (optional)], and checksum (optional)</p>
</div>


                            </div>
                            <div id="Message.add_no_carry" class="classattr">
                                            <div class="attr function">
                        <div class="decorator">@staticmethod</div>

                <span class="def">def</span>
                <span class="name">add_no_carry</span><span class="signature">(*args)</span>:
        </div>

                        <details>
                <summary class="button">View Source</summary>
                <div class="codehilite"><pre><span></span>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_no_carry</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Addition without carry; addition is not carried to the next decimal up.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : iterable (not string)</span>
<span class="sd">            Iterate of ints to add without carry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        final_sum : int</span>
<span class="sd">            the result...</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 1)</span>
<span class="sd">        2</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 18)</span>
<span class="sd">        19</span>

<span class="sd">        &gt;&gt;&gt; add_no_carry(1, 19)</span>
<span class="sd">        10</span>

<span class="sd">        The &#39;10&#39; is not carried over to the next decimal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_digits</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">num_digits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span>
        
        <span class="n">max_digits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">num_digits</span><span class="p">)</span> 
        <span class="c1"># list comprehension way</span>
        <span class="c1"># max_digits = max([len(str(arg)) for arg in args])</span>
        <span class="n">final_sum</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">pwr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_digits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># iterate through ea decimal</span>
            <span class="n">result_no_carry</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">pwr</span><span class="p">:</span>
                    <span class="c1"># modulus sets the current decimal as the most significant </span>
                    <span class="c1"># decimal</span>
                    <span class="c1"># floor div selects the most significant decimal</span>
                    <span class="n">result_no_carry</span> <span class="o">+=</span> <span class="n">arg</span> <span class="o">%</span> <span class="mi">10</span><span class="o">**</span><span class="n">pwr</span> <span class="o">//</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">pwr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    
            <span class="c1"># list comprehension way</span>
            <span class="c1"># result_no_carry = sum([arg % 10**pwr // 10**(pwr - 1) for arg in args if len(str(arg)) &gt;= pwr])</span>
            
            <span class="c1"># final_sum = str(result_no_carry % 10) + final_sum</span>
            <span class="n">final_sum</span> <span class="o">+=</span> <span class="n">result_no_carry</span> <span class="o">%</span> <span class="mi">10</span>
            
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">final_sum</span><span class="p">)</span>
</pre></div>

            </details>

                    <div class="docstring"><p>Addition without carry; addition is not carried to the next decimal up.</p>

<h2 id="parameters">Parameters</h2>

<p>*args : iterable (not string)
    Iterate of ints to add without carry.</p>

<h2 id="returns">Returns</h2>

<p>final_sum : int
    the result...</p>

<h2 id="examples">Examples</h2>

<pre><code>&gt;&gt;&gt; add_no_carry(1, 1)
2



&gt;&gt;&gt; add_no_carry(1, 18)
19



&gt;&gt;&gt; add_no_carry(1, 19)
10
</code></pre>

<p>The '10' is not carried over to the next decimal.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>